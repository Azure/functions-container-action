jobs:
  - job: "Build_AND_Start_CodeQL_Reporting"
    variables:
      ApplicationInsightAgentVersion: 3.4.16
      Codeql.Enabled: true
      Codeql.Language: javascript

    pool:
      name: '1ES-Hosted-AzFunc'
      demands:
        - ImageOverride -equals MMS2019TLS
    
    steps:
    - checkout: self
    - task: CodeQL3000Init@0
      inputs:
        Enabled: true
        Language: javascript

    # Build tasks
    - task: Bash@3
      displayName: 'Build project' 
      inputs:
        targetType: 'inline'
        script: |
          npm install
          npm run build
    - task: CodeQL3000Finalize@0
      condition: always()